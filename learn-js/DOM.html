<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <button onclick="load()">load</button>
    <button onclick="load2()">load2</button>
    <div style="display: grid; grid-template-columns: 1fr 1fr">
      <div id="list"></div>
      <div id="list2"></div>
    </div>

    <script>
      function load() {
        console.time("load");
        const list = document.getElementById("list");
        const fragment = document.createDocumentFragment();
        // fragment: 메모리에만 존재하기때문에 리페인트와 리플로우를 하지 않음
        const items = [];
        // 리플로우와 리페인트 최소화

        for (let i = 0; i < 180000; i++) {
          const item = document.createElement("li");
          item.textContent = `Item ${i}`;
          fragment.append(item); // 메모리에 저장
          // items.push(item);
        }
        // 가상돔에 렌더링을 하고 원본을 복사한 다른 가상 돔과 비교를 한 후에 변경점을 렌더링하여 리렌더링을 최소화한다.

        // 생성된 요소들을 한 번에 DOM에 추가
        // list.append(...items); // 1회
        list.appendChild(fragment); // 1회
        // 리플로우 리페인트가 한번만 일어남

        // DOM 추가 후 완료 시간을 측정
        setTimeout(() => {
          console.timeEnd("load");
        }, 0); // 렌더링이 완료된 후 시간을 측정하기 위해 0ms 지연
      }

      function load2() {
        console.time("load2");
        const list = document.getElementById("list2");
        const items = [];
        // 리플로우 리페인트 최적화 X
        // li가 추가될 때마다 리플로우 리페인트를 실행한다.

        for (let i = 0; i < 180000; i++) {
          const item = document.createElement("li");
          item.textContent = `Item ${i}`;
          list.appendChild(item);
        } // 9만번의 리플로우와 리페인트를 요구

        // DOM 추가 후 완료 시간을 측정
        setTimeout(() => {
          console.timeEnd("load2");
        }, 0); // 렌더링이 완료된 후 시간을 측정하기 위해 0ms 지연
      }
    </script>
  </body>
</html>

<!-- 렌더링은 최대 50회 이내로 권장된다. 되도록이면 매우 적게 일어나도록 해야 한다. -->
<!-- 웹 브라우저 최적화 하는 방법?
 리플로우 리페인트를 최소화
 어떤 메서드?
 DocumentFragment -->
<!-- transform은 이론상 성능을 떨어지게 하는 요소로 작용할 수 없다 -->
